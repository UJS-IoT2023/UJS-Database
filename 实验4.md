# 实验四 数据库的统计输出

## 实验要求

1. 找出向天津供应商购买重量大于15的零件的工程号；

2. 找出工程项目J2使用的各种零件的名称及其数量；

3. 按工程号递增的顺序列出每个工程购买的零件总数；

4. 编程输出如下报表：

|         |        |          |        |
| ------- | ------ | -------- | ------ |
| **供应商** | **零件** | **工程项目** | **数量** |

## 实验内容

**找出天津供应商购买重量大于15的零件工程号**

```sql
SELECT DISTINCT supplier_part_project.project_id
FROM supplier_part_project
JOIN suppliers ON supplier_part_project.supplier_id = suppliers.supplier_id
JOIN parts ON supplier_part_project.part_id = parts.part_id
WHERE suppliers.city = '天津' AND parts.weight > 15;
```

| project\_id |
|:----------- |
| J2          |
| J3          |
| J4          |

**找出工程项目 J2 实用的各种零件的名称以及数量**

```sql
SELECT parts.part_name, supplier_part_project.quantity
FROM supplier_part_project
JOIN parts ON supplier_part_project.part_id = parts.part_id
WHERE supplier_part_project.project_id = 'J2'
ORDER BY part_name;
```

| part\_name | quantity |
|:---------- |:-------- |
| 螺栓         | 100      |
| 齿轮         | 200      |

**按工程号递增的顺序列出每个工程购买的零件总数**

```sql
SELECT project_id, sum(quantity) AS total_parts
FROM supplier_part_project
GROUP BY project_id 
ORDER BY project_id;
```

| project\_id | total\_parts |
|:----------- |:------------ |
| J1          | 400          |
| J2          | 300          |
| J3          | 400          |
| J4          | 1500         |

**输出报表**

```sql
SELECT
    suppliers.supplier_name AS 供应商,
    parts.part_name AS 零件,
    projects.project_name AS 工程项目,
    supplier_part_project.quantity AS 数量
FROM supplier_part_project
JOIN suppliers ON supplier_part_project.supplier_id = suppliers.supplier_id
JOIN parts ON supplier_part_project.part_id = parts.part_id
JOIN projects ON supplier_part_project.project_id = projects.project_id
ORDER BY supplier_name, project_name, part_name;
```

| 供应商 | 零件  | 工程项目 | 数量  |
|:--- |:--- |:---- |:--- |
| 东方红 | 螺母  | 三建   | 200 |
| 丰泰盛 | 齿轮  | 弹簧厂  | 300 |
| 丰泰盛 | 齿轮  | 造船厂  | 200 |
| 为民  | 齿轮  | 一汽   | 200 |
| 为民  | 螺栓  | 造船厂  | 100 |
| 为民  | 齿轮  | 造船厂  | 500 |
| 盛锡  | 螺母  | 三建   | 200 |
| 精益  | 螺栓  | 一汽   | 100 |
| 精益  | 螺母  | 弹簧厂  | 100 |
| 精益  | 螺母  | 造船厂  | 700 |
